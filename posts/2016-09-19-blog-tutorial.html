<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Blog tutorial - Styx Site</title>
<link href="https://styx-static.github.io/styx-theme-nix/feed.xml" rel="alternate" type="application/atom+xml" />
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet" type="text/css" />
<link href="//fonts.googleapis.com/css?family=Inconsolata|Open+Sans|Roboto|Montserrat|Concert+One" rel="stylesheet" type="text/css" />
<link href="https://styx-static.github.io/styx-theme-nix/css/nix.css" rel="stylesheet" type="text/css" />
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top font-header" id="navbar">
<div class="container-fluid">
<div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
    <span class="sr-only">Toggle navigation</span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="navbar-brand" id="green-terminal" href="https://styx-static.github.io/styx-theme-nix/">Styx Site</a>
</div>
<div class="collapse navbar-collapse" id="navbar-collapse">
<ul class="nav navbar-nav navbar-right">
<li><a href="https://styx-static.github.io/styx-theme-nix/about.html">~/about</a></li>
<li><a href="https://styx-static.github.io/styx-theme-nix/posts/index.html">~/posts</a></li>
</ul>
</div>
</div>
</nav>
<div class="container wrapper">
<h1>Blog tutorial</h1>
<span class="post-date">19 Sep, 2016</span>
<div class="post-content">
<div class="sect1">
<h2 id="_create_a_new_site">Create a new site</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we will use the styx <code>new</code> command to generate files required for a new site:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx new site my-blog
$ cd my-blog</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>styx new site</code> will generate the following file structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">my-blog
├── conf.nix
├── data
├── readme.md
├── site.nix
└── themes</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most important file is <code>site.nix</code>, it contains all the logic to generate our site.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_declare_themes">Declare Themes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <code>site.nix</code>, find the line declaring the themes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  themes = [
  ];</code></pre>
</div>
</div>
<div class="paragraph">
<p>And change it to the following to load the Hyde and generic templates themes. (Hyde requires the generic templates theme)<br/>
Later themes in the list have higher priority.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  themes = [
    styx-themes.generic-templates
    styx-themes.hyde
  ];</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_an_index_page">Create an index page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next, we will create an index page, in <code>site.nix</code> find the line declaring the <code>pages</code> attribute set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = rec {
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>And let&#8217;s add an index page, a page is an attribute set defining at least <code>template</code>, <code>layout</code> and <code>path</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = rec {
    index = {
      title    = "Home";
      path     = "/index.html";
      template = templates.index;
      layout   = templates.layout;
    };
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The site can be previewed by running <code>styx preview</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx preview</code></pre>
</div>
</div>
<div class="paragraph">
<p>The site will be accessible at <a href="http://127.0.0.1:8080" class="bare">http://127.0.0.1:8080</a>.
To end the preview, hit <code>Ctrl+C</code>.</p>
</div>
<div class="paragraph">
<p>If anything goes wrong during the preview, you can use the <code>--show-trace</code> flag to make styx print a debug trace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx preview --show-trace</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_data">Create data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our index page should list our blog posts, so we will need to generate some data and create pages in our new blog.<br/>
Then <code>gen-sample-data</code> command that will generate some data for us:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx gen-sample-data</code></pre>
</div>
</div>
<div class="paragraph">
<p>This generate the following data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">data
└── sample
    ├── pages
    │   └── about.md
    └── posts
        ├── 2016-09-13-drafts.md
        ├── 2016-09-14-pages.md
        ├── 2016-09-15-data.md
        ├── 2016-09-16-themes.md
        ├── 2016-09-17-media.md
        ├── 2016-09-18-features.md
        └── 2016-09-19-blog-tutorial.adoc</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_a_page">Adding a page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the sample data, there is an about page. Lets add it to our site.</p>
</div>
<div class="paragraph">
<p>First we need to load its data, is a single file, so we will use <code>loadFile</code>:</p>
</div>
<div class="paragraph">
<p>Find the following line declaring the <code>data</code> set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  data = {
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>And change it to load the about page data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  data = {
    about = lib.loadFile { file = ./data/sample/pages/about.md; inherit env; };
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the page in the <code>pages</code> set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = {
    index = {
      title    = "Home";
      path     = "/index.html";
      template = templates.index;
      layout   = templates.layout;
    };

    about = data.about // {
      path     = "/about.html";
      template = templates.page.full;
      layout   = templates.layout;
    };
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make the page easily accessible, we can add an entry in the sidebar for the about page by adding a <code>menu</code> to our <code>data</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  data = {
    about = lib.loadFile { file = ./data/sample/pages/about.md; inherit env; };
    menu  = [ pages.about ];
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can preview the site again with the <code>styx preview</code> command and verify that there is a link for the about page in the sidebar.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_add_posts">Add posts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next we can add our posts, lets add a <code>posts</code> attribute to the <code>data</code> set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  data = {
    about = lib.loadFile { file = ./data/sample/pages/about.md; inherit env; };
    menu  = [ pages.about ];
    posts = lib.sortBy "date" "dsc" (lib.loadDir { dir = ./data/sample/posts; inherit env; });
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>loadDir</code> load all the data inside a directory and <code>sortBy</code> sort it.</p>
</div>
<div class="paragraph">
<p>To generate pages, we need to add them to the <code>pages</code> attribute set.<br/>
In the <code>pages</code> set, add the posts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = rec {
    index = {
      title    = "Home";
      path     = "/index.html";
      template = templates.index;
      layout   = templates.layout;
    };

    about = data.about // {
      path     = "/about.html";
      template = templates.page.full;
      layout   = templates.layout;
    };

    posts = lib.mkPageList {
      data       = data.posts;
      pathPrefix = "/posts/";
      template   = templates.post.full;
      layout     = templates.layout;
    };
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>mkPageList</code> takes a list of data and generate a list of pages.</p>
</div>
<div class="paragraph">
<p>Lets preview our site again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx preview</code></pre>
</div>
</div>
<div class="paragraph">
<p>Posts are generated, but are not listed on the index page yet.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_index_page_revisited">Index page revisited</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hyde is designed so the most recent posts appears on the index page, and older posts are on archive pages.<br/>
So we need to split our posts between the index and archive pages.</p>
</div>
<div class="paragraph">
<p>There is a <code>mkSplit</code> function that does just that.<br/>
So we will adapt our index page declaration to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = rec {
    index = lib.mkSplit {
      title        = "Home";
      basePath     = "/index";
      itemsPerPage = conf.theme.itemsPerPage;
      template     = templates.index;
      data         = posts.list;
      layout       = templates.layout;
    };

    ...
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>mkSplit</code> takes a list of <code>data</code> and make multiple pages of <code>itemsPerPage</code> item each.<br/>
Pages path is automatically generated by using <code>basePath</code>.</p>
</div>
<div class="paragraph">
<p>Lets preview our site again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx preview</code></pre>
</div>
</div>
<div class="paragraph">
<p>Posts are listed on the index page, and archive pages are also generated, all good.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_an_atom_feed">Adding an atom feed</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next step is adding an atom feed.<br/>
To do so, we just need to create a page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = {
    ...

    feed = {
      path     = "/feed.xml";
      template = templates.feed.atom;
      layout   = lib.id;
      items    = lib.take 10 posts.list;
    };
  };</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_checking_the_links">Checking the links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Styx have a linkcheck functionality that check internal links of a site:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx linkcheck</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_improvements">Improvements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_customizing_our_site">Customizing our site</h3>
<div class="paragraph">
<p>The Hyde theme provide some configuration options that can be used to customize our blog.</p>
</div>
<div class="paragraph">
<p>The following command will generate a documentation for our site, so we can check the avalaible theme options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">$ styx site-doc</code></pre>
</div>
</div>
<div class="paragraph">
<p>To change the theme options, edit <code>conf.nix</code> at site root and find the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  theme = {
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>And change it to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  theme = {
    site.title   = "My Styx Blog";
    colorScheme  = "0d";
    itemsPerPage = 5;
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s preview our site and see what changed.</p>
</div>
<div class="paragraph">
<p>There are a few posts using source code examples, it would be nice to have syntax highlighting.<br/>
Syntax highlighting can also be enabled via the configuration interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  theme = {
    site.title   = "My Styx Blog";
    colorScheme  = "0d";
    itemsPerPage = 5;
    lib.highlightjs = {
      enable = true;
      style = "monokai";
      extraLanguages = [ "nix" ];
    };
  };</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cleaning_up">Cleaning up</h3>
<div class="paragraph">
<p>All of our pages are declaring the same <code>layout</code>.<br/>
It is possible to set attributes to every page when converting our page set to a page list.</p>
</div>
<div class="paragraph">
<p>In <code>site.nix</code> find:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pageList = lib.pagesToList { inherit pages; };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s add the default layout here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pageList = lib.pagesToList { inherit pages; default = { layout = templates.layout; }; };</code></pre>
</div>
</div>
<div class="paragraph">
<p>And remove all the <code>layout</code> declarations using <code>templates.layout</code> of our pages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-nix" data-lang="nix">  pages = rec {
    index = lib.mkSplit {
      title        = "Home";
      basePath     = "/index";
      itemsPerPage = conf.theme.itemsPerPage;
      template     = templates.index;
      data         = posts.list;
    };

    posts = lib.mkPageList {
      data       = data.posts;
      pathPrefix = "/posts/";
      template   = templates.post.full;
    };

    about = data.about // {
      path     = "/about.html";
      template = templates.page.full;
      layout   = templates.layout;
    };

    feed = {
      path     = "/feed.xml";
      template = templates.feed.atom;
      layout   = lib.id;
      items    = lib.take 10 posts.list;
    };
  };</code></pre>
</div>
</div>
</div>
</div>
</div>


 
</div>

</div>
<footer class="footer text-center">
  <p>&copy; 2017. All rights reserved. 
</p>
</footer>
<script crossorigin="anonymous" src="//code.jquery.com/jquery-3.1.1.min.js"></script>
<script crossorigin="anonymous" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script crossorigin="anonymous" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script crossorigin="anonymous" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/nix.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>